from flask import Blueprint, requestfrom scholarly import search_pubs_queryfrom application import loggerfrom application.utils.decorators import json_responsebp_publication = Blueprint("bp_publication", __name__)@bp_publication.route("/publication", methods=["GET"])@json_responsedef get_publication():    resd = {"status": "ok"}    query = request.json["query"]    logger.info(f'I am in get_publication with {query}')    query_result = search_pubs_query(query)    logger.info(f'Query_result: {query_result}')    try:        pub_info = next(query_result).fill()    except StopIteration:        logger.info(f'Publication for query ({query}) not found.')        resd["status"] = "failure"        resd["failure_detail"] = "Publication not found."        return resd, 404    if not pub_info:        logger.info(f'Publication for query ({query}) not found.')        resd["status"] = "failure"        resd["failure_detail"] = "Publication not found."        return resd, 404    # Parse to dictionary as suitable with database columns.    resd["publication"] = {        "ident": pub_info.id_citations.split(":")[1],        "title": pub_info.bib["title"].replace("\n", " ").replace(            "\r", " ").replace("\t", " ").strip(),        "year": pub_info.bib.get("year", None),        "url": pub_info.bib.get("url", None),        "source_url": pub_info.bib.get("eprint", None),        "cited_by": getattr(pub_info, "citedby", 0)    }    return resd, 200
import osimport base64import requestsfrom flask import current_appfrom application import celery, loggerfrom application.utils.helpers import extract_file_name_from_url@celery.task(bind=True, name="download_pdf")def task_download_pdf(url: str):    resd = {"status": "ok"}    files_path = current_app.config["FILES_PATH"]    file_name = extract_file_name_from_url(url)    if not os.path.exists(files_path):        os.makedirs(files_path)    try:        pdf_raw = requests.get(url).content        full_path = f'{files_path}/{file_name}.pdf'        with open(full_path, "wb+") as f:            f.write(pdf_raw)        resd["path"] = full_path        resd["raw_base64"] = base64.encodebytes(pdf_raw).decode("utf-8")    except Exception as e:        logger.exception(e)        resd["status"] = "failure"        resd["failure_detail"] = str(e)    return resd